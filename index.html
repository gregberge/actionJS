<!DOCTYPE html> 
 
<html lang="fr"> 
<head> 
  <meta charset="UTF-8"> 
  <title>Action JS</title> 
  <script type="text/javascript" src="jquery.min.js?1"></script> 
  <script type="text/javascript" src="action-js.js?1"></script> 
</head> 
<body> 
<script type="text/javascript"> 
 
jQuery(function(){
 
var stage = new aj.Stage("game");
 
var sayOk = function(event)
{
	//alert("ok");
	eventDispatcher.removeEventListener(event.type, sayOk);
};
 
var event = new aj.Event("START");
var eventDispatcher = new aj.EventDispatcher();
eventDispatcher.addEventListener(event.type, sayOk);
eventDispatcher.dispatchEvent(event);
 
 
var displayObject = new aj.Sprite();
displayObject.height = 20;
displayObject.width = 300;
displayObject.alpha = 0.3;
displayObject.x = 20;
 
var imageObject = new aj.Image("http://www.celticminded.com/forums/images/smilies/Mickey.gif");
imageObject.height = 50;
imageObject.width = 50;
imageObject.x = 20;
 
 
imageObject.addEventListener(aj.MouseEvent.CLICK, killMickey);
 
var eventApuMickey = new aj.Event("pumickey");
eventApuMickey.coucou = "Mickey est mort !";
 
imageObject.addEventListener(eventApuMickey.type, function(event){ alert(event.coucou); });
imageObject.name = "image";
 
var displayObjectContainer = new aj.DisplayObjectContainer();
displayObjectContainer.x = 200;
displayObjectContainer.y = 200;
displayObjectContainer.name = "container";
 
displayObject.addChild(imageObject);
displayObjectContainer.addChild(displayObject);
displayObject.mouseEnabled = true;
displayObject.name = "dispobj";
 
function moveImage()
{
	if(imageObject)
	{
		if(imageObject.x < 300)
		{
			imageObject.x = imageObject.x + 1;
		}
		else
		{
			imageObject.x = 20;
		}
	}
};
 
function killMickey()
{
	imageObject.alpha -= 0.4;
		
	if(imageObject.alpha == 0)
	{
		imageObject.dispatchEvent(eventApuMickey);
		imageObject = null;
	}
};
 
stage.addChild(displayObjectContainer);
stage.addEventListener(aj.Event.ENTER_FRAME, moveImage);
//console.log(imageObject.localToGlobal(imageObject.getCoordPoint()));
 
});
</script> 
 
<canvas id="game" width="500" height="500"></div> 
</body> 
</html>